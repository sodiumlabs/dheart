package core

import (
	"encoding/json"

	"github.com/sodiumlabs/dheart/core/config"
	"github.com/sodiumlabs/dheart/db"
	"github.com/sodiumlabs/tss-lib/ecdsa/keygen"
)

var (
	// Copied from preparams json file in tests.
	Preparams = []string{
		`{"PaillierSK":{"N":20988117346843663540335999488355070160621886330217414468672501921179281959291022109699786369406738335531294904510372150802611489881785511720638219911485067606999627160999932173537005518747217502294724533070183008760669397215597253846363322011196387959379735453967402218176844542414741061455149491445006472285609303012686675007054532002025516875447919478432602334867844785345937688045577763338914491525961334192270523432214720153625940251024728697927873007066404974333074679209518020768078516642466544255058986986701922924741446303226698221707121384796841555588650070559403680995012588851100916728687595121142162539109,"LambdaN":10494058673421831770167999744177535080310943165108707234336250960589640979645511054849893184703369167765647452255186075401305744940892755860319109955742533803499813580499966086768502759373608751147362266535091504380334698607798626923181661005598193979689867726983701109088422271207370530727574745722503236142659639515838884670291799887677045800614388183817797554337097130041565339371242571196305884772252720200882835826286665716756193500614615212976974563037333608239566282095148016284067421289031735365393118147021639804679542150844663320102167954006919861714586379551994752268023408633819213331827060145750717418102,"PhiN":20988117346843663540335999488355070160621886330217414468672501921179281959291022109699786369406738335531294904510372150802611489881785511720638219911485067606999627160999932173537005518747217502294724533070183008760669397215597253846363322011196387959379735453967402218176844542414741061455149491445006472285319279031677769340583599775354091601228776367635595108674194260083130678742485142392611769544505440401765671652573331433512387001229230425953949126074667216479132564190296032568134842578063470730786236294043279609359084301689326640204335908013839723429172759103989504536046817267638426663654120291501434836204},"NTildei":27950798570900670100876657260420279684182809159891299582705232572844329436935189572111728932907085583844690124133309669468190777488041467703525270137194300774105375984643880184462445630042729310023358890125370012523296472767647783834954922215896365368185317697696215676088009118505547374212932889392164249631533804408802685204292449065793940787655189249965203753684260113513747629562133684257700790260199440152870018715909013039628251690248096112337313398892682924274229130263125424269766493019971395597809001456812095788119831527110907873076581949769743579251568542376750655361633976323454828145607778643233690250333,"H1i":15893700092939815334537200348779413831710206865368026617714396801730093121302914435016457173347901449456145873088625420074599140125366863022960515244462145211262448421818152149635468832203569872911125787456729838819504658240319158483617909033810660393745214182700624048246456076308339982489448757161256666587859575211805613322258134874270416542362105944679138698731475932283298810713372205325960779908360934179345966358117588120695948168582283456310096527421895388591863915800996814057705244589233267938433842143104116234106387016116499551382142358010547457945682986520704790386371016314579591597970321563141182317475,"H2i":16986592873315225583542593599635566858359220577191836317214090517468378521709870478124283223576541018396039101678102068708430816956478208590515738821719102112331365953165735950556681252611387583068686780796930976196300457379853342697512406453436109153064211096858791835572193045082565230087756465235744709262817050438884547221890510672528952807945653186157871318324042823464638037430847738319640728304776017716197117107505346679541362236605769456513479875260752920623533576634483664194016078486099068172162727916286058898037812180958231599030448673615305950960333219012170989763832179150906423344139863867318383016211,"Alpha":24593777022677937033591418852021928259599693637185198263156515716306496408936566539451357876569121264617013737143477962787744906112547358378812278453435469237000887212574079451290168975419833882485798554171221931439344304385135125680419426700704480247461587367757741232463530479573450606121747517035008793595913375212730636173165716400641092151744820346631988442475114894242791818605364163257867111256314241075389606138425343681343299964124815307736254332842496999235938192626408812749583851476057887723536346033855035416626209409280967222478924769059464238566821318126599638656726631336844435250346939368105716893680,"Beta":4368222230107634753065835342996439675892667939126383239808477134369688672597975471162751425938429054566337658591356079188424391504726684553115599158743599771275537830458031038542021892452207381407049670641606635751315679767403671424322580187511357965363976002556052569659040056484554931176002660591922499443707197984075052628835915460963888896602639409503192654864534828840747819945566741886638518805353243936298054962565011878991095278300550983513726669480189093964703848074617473042188669326948367171913092753469270847251325307394763116864276494510176553129766913842946162207129131699632451789404200341453505060628,"P":87274755247470833693395305473786245834213832863104472523568981198048176534061537936064944007781979926804953962769511183529813029283941784651100924178741355741760293362386807702687280248931274242843550211776032744852305044056820011918548339499266554556464468086180530533802435320737043539126562223721908503743,"Q":80065531239947723246713380916886192595904255982884443281038796500920960589292151989205613500973975283948635189147940042260262820322176450778210447629434749973789952681447095686614620570633635658600091854626530068799307677338171985383559316741994784580941196129693287009819461320936858698754242814907303718929}`,
		`{"PaillierSK":{"N":23480897859705367187360013655993002874696507573399090370367450600741674143612782815231368701976721918220624096153394674399965180369717021624161950203435380564000790363090629447493193786420968214111997892021744965629859603164611502558970107643962845211496101002783917945105602018719068763680547011703564524107693548186023252849089663729522833751374999990660396858342462388043074195138209203326680579450944482483773314657058392707099394374453496964938112446033521050487059183053467089278564065644440528653455875465666851016727443855600662388149047412847554234085521054397952009749548485638168458774713079219449410704493,"LambdaN":11740448929852683593680006827996501437348253786699545185183725300370837071806391407615684350988360959110312048076697337199982590184858510812080975101717690282000395181545314723746596893210484107055998946010872482814929801582305751279485053821981422605748050501391958972552801009359534381840273505851782262053693297680036611552596774640843647557964483816729674262821405290195345478525364515261126304788824795136844475492169651925493618420380867833030442978557248150116332943328256734097604576022292794395919291897527244012161524093627484664688463214700820786744669750684763324028917782566741425964233589394183940712014,"PhiN":23480897859705367187360013655993002874696507573399090370367450600741674143612782815231368701976721918220624096153394674399965180369717021624161950203435380564000790363090629447493193786420968214111997892021744965629859603164611502558970107643962845211496101002783917945105602018719068763680547011703564524107386595360073223105193549281687295115928967633459348525642810580390690957050729030522252609577649590273688950984339303850987236840761735666060885957114496300232665886656513468195209152044585588791838583795054488024323048187254969329376926429401641573489339501369526648057835565133482851928467178788367881424028},"NTildei":29671683534577314336172209528062719894010653861179051883720666531492499892227130554343600604137979639038102476575570384106688730952384617155299207873743717295834669038468880200020944789536315026714132993483006395109421359649084021008922517295513181775626364309159535732165899289912203795784307618069052200116570026698032447804112580061051509936886912405312730009870735616001112858422961361250682749830791427132204824102118535635960148900360229176146057885664508883175958249803376403020489092772682214817246148718275074950915759623258643456654996366503201790918593002520799243415417226065148636195421867364334004999577,"H1i":15569075867951770905405721346447505985985163058597239465309659932644035788559452608592143277149389706638019446573554199325042044739180453666196212111903939804327103055906008860160916383752614404384697405820628511553568086163444930533399807856779563189243397213719691818614645945827968739148690959164962568320984492621197381157591660969468480128564227450827022127298869803308210495108325130809262768044296810574093452862609413677949254831386376003136680629790605776510601900004422221265065318891536399240084054957056335351021185224153873059767638113980662453668438825058415129452389526754849408520507414119793010303016,"H2i":28891411290420294643092837042879593533269307598380674556230101674586606350021058884988680839066534170674851623402157644107784167096501271513592475506730994333127423639426689541398857003086673280874515278983051152230082159387722008179103950620737056036034137237204413705931595112392211175067605567285233428640641974650218596869168450866432507805474787192694462069715267785746320190632093082395413251419433810749728831599955466326136972794104593356976142467209596384046264188766151810952641393940376691686902132843267492490545296057362667554853119447528134954238196844910689810261458744012601024762236409764799914566640,"Alpha":17002543138575204312886890597857967301883306130121280336768657414227669866972297344434341074574195542055397075480538695438925722699736703412973470407678865646678157035624604319006694794211104020147316216986968570776431231561539479796494067713738260344543386791951639941583666547114225082399892500388715584838047523460492030932257139403727845857782871779633685766997263467790592949920306998785291436367559357965372766713184838740266134794475258843007262817310246029994607016898477209221460694881737930996338485262689671403333776754402299219837807217858974108044535985972392420929223920659897208769858425008792017917367,"Beta":5367307206163126004722262007783721973015265042950101412191361136612964343816772786998588544000958221787378291669910894498605792898157204120698568445625173334951619349162918565764986649207622219169951590801487768486403126244578599153493395080993281303881759996724491041232552093856403125350889907883393631568257602220442899935207633919283107171542047460787948689334954498083229525912697033118686898838039786052666542730958721413657374916958905297314002730683114900263865766668069077394951071645154370545063011145580089199176447699061329363029952812523381087832407435277023980313969227935584812319596778067862071517348,"P":84994444045517213683586775183880722791489964486177918796197052542620115156462018975584025620058379264777800830459289735101747820346781529106537624981058637310122274667992905043121978710672317410995907289222027527099814649792865567085601713193488168789125600636563086226550699342671230304422527607670882632611,"Q":87275362136280311173911121471201839164339601211126101834909246302803659166585994354221490239063280039443577510721566699584258156697941227950709409286302484323412651327080755858295472130298068740253673997554865423482563702655858399031280143865655119196520874658823610549741374586882007787480955646710175798799}`,
		`{"PaillierSK":{"N":25274398240743045422112559229367505480739743155884840986730902979959066853227661201136710565978717584863321090027839449890985456723569276763022725784089832505107831643285936549491820132707343411571017506192088408990095159522782861626021191080596928579214742953716369051456349743069668519478142444853721238510742845622490897284964202612469365964287891925079488137286715889771993223857887327960267298250360753391209898993734170017043326062693924319147311068463418699912071999368351282263583930857685784111296688879581731653806925365976853024906847983153969626464696866101803233611075426805356743598007545006751497232761,"LambdaN":12637199120371522711056279614683752740369871577942420493365451489979533426613830600568355282989358792431660545013919724945492728361784638381511362892044916252553915821642968274745910066353671705785508753096044204495047579761391430813010595540298464289607371476858184525728174871534834259739071222426860619255212302649325717469851039505123959370366094662183480766473021502963927219868347338883566881725050025950382015453601526711790369691576149471268327505604219920796041598504553546828495627302335092205943352546482742643048648734444320714450631404125749622532100725914880682337386332035285764490267789747386094601786,"PhiN":25274398240743045422112559229367505480739743155884840986730902979959066853227661201136710565978717584863321090027839449890985456723569276763022725784089832505107831643285936549491820132707343411571017506192088408990095159522782861626021191080596928579214742953716369051456349743069668519478142444853721238510424605298651434939702079010247918740732189324366961532946043005927854439736694677767133763450100051900764030907203053423580739383152298942536655011208439841592083197009107093656991254604670184411886705092965485286097297468888641428901262808251499245064201451829761364674772664070571528980535579494772189203572},"NTildei":22363432448309193969617418936932738288554657083414867460905983656978698043176762697149769464100156724259353274171953643646393302545496216389737260876832937027220712119082665698234591116427441191103362112960717296570372928814357569970206983562348319936144245813449116959840806301166027598595167609089286900610866055775894732699096447858378419299354701511919244711790197375154190309547705329831342062567870459563670608917145826941163617741584397343935255829155547021550210402311076490105800254898611196319316278997456045357274523587970050683807249832636736407025898402465481943147938550077034314941251153974183942869717,"H1i":9452821592227412557076575107771791437704770236145708570118680771482324739861881486718173924664240186284900841697816732803784206589170248508059848870549970003698844152106084352601991999436266739497830736926686659392619391865698614331453091437021215779947943723502729797615095643755590970681699150387318531543568182656719779863228192968782422923780413022721807945668038418576602004310959446662337330720519701348052916914793785228106055035480242306107456193445552071765893133000547670233950638691773033811070295854554457693104559653005841993397004593803066264116115104505541263457708169828585244176827022889324553904924,"H2i":11640691393488789533882521712155359426948743372390753814539722408994704009031004003732699082225884866048604656612512418244992451866456774671539342234927757864636912049995499773942949276341173755814658826330799060841051179183871140638760564613886257866710966033542193335523988319761438115571064409503476260064907215381834471539329014819746572282378853089028305661764248716073603845568586835260524179213625975150407108106503546102679615306727066129969205602303709004739908473010062501895710498750671079609206246466781606843936302069140618694524095813904753390391400469783834523506679823707469297209883136750365783118994,"Alpha":11531884857363412413954022979949233421909722056273091450307291197386062717445880647935677118719424788220968213979986283038050665815245836308078238515419207139545534612053903747393769886711807790889961400464559519500865149758578937779070743506255298839971005867595034943598064023374730798998155844537555912242070179338376441609783474796405793028494253478826675952983439267707107928280693812875719793531590898602750144996141153586643115757142475788296611695506736664492337402130599094772902872654642461136070613019811773435900771775332500505338320828328532649877305079664652533050710544347812986160884288999055866888056,"Beta":789322251468231588765644617786461252593237623096109768427715584016807168172934391801049917913794702386459624818482288666318143398220739660752435920501636511140419182664642641487032617333354781566876586625952121274941824668069961401956516382564355210460527831263156734312855806831696326320713558265609523265269951818985681148325615489543121750352159461073529266869562768425256936083989268968312219690729250294772586562734556675498167509439148593076180253930085993360580772892887500555559093925356018123917271862718609478262800606212111188988428117092495021523007204213740377996318891819901562687921020681149890727998,"P":78461818142238657850652993075668505948183480205507684387881843351980224847698008796905057249683105624142067288142381495592985021976460518393055474150174428885068222073256964406550936192409643616096089051851601357325647903514441484583672093140616631881768572089537951763575477825063287827386562855987712853111,"Q":71255780766410126669379549970283989258554796692466505925464544927466364316112786006916134328181876794900150256770761437479936451946932879264137032313898008421381640860894591019606130031191539585988030522174439479451881184016488417563942132276982476984096137999806502073709699610553867400368383759431691107389}`,
		`{"PaillierSK":{"N":24423193199528760057917437429488784720355677692029929828350854657115841272576565086049920492411622802556331083973455519301845273024183566780586370252084074728617597072501303958915876886186506082838833935678625621370426536038762452244702438212796595274636626781893770960591711313965991206022742840071196705931007495172296219306200325570133462572917166068832581360024478423480874411806584964894064806175248978638849971411001340452501420451309786035211000399233655106276594862302333984644316257463957808424501669620282458120132300918081032275059245079120836685469163023225761298759863022324707997682188908043638894373437,"LambdaN":12211596599764380028958718714744392360177838846014964914175427328557920636288282543024960246205811401278165541986727759650922636512091783390293185126042037364308798536250651979457938443093253041419416967839312810685213268019381226122351219106398297637318313390946885480295855656982995603011371420035598352965347098791336397006818349370934554314637541929945651422321000695390333421538621978210204922224558916432803655631988800909265523959846731496011476150800980272687910981228496257991146168554023795267385657644946113601269781012499685704842601427488028636271785369927612692261284090190943645573371051058403305594958,"PhiN":24423193199528760057917437429488784720355677692029929828350854657115841272576565086049920492411622802556331083973455519301845273024183566780586370252084074728617597072501303958915876886186506082838833935678625621370426536038762452244702438212796595274636626781893770960591711313965991206022742840071196705930694197582672794013636698741869108629275083859891302844642001390780666843077243956420409844449117832865607311263977601818531047919693462992022952301601960545375821962456992515982292337108047590534771315289892227202539562024999371409685202854976057272543570739855225384522568180381887291146742102116806611189916},"NTildei":26663829634261358932439480929292032403383629822009463344170400917936867258108731483187552056139006115208365744371234360602926483765315994880237079399098287277918086726804644581326959898431928732940729086870501014364482094288617374846921675512622954331374466015802114381412883461019887371921041062452408366269750330216728247232268165563650451805481009881288525376577727955842016906229348813338678923462818451833957808842968528522537046357107955841350572947615152021713520918305630737178920775354339106680983096577932336904584861222751867277033030354089808879334169647656729131505523686183639821446638915750575958024153,"H1i":13636881780418929593673223057988979756396047230085184893768487688696032310556853815965188742397106911002326673406073795459218558492959052137079766761929422340763787163476826772596942821203571048587946723821321690453007476575549539181703242238921178170404071232945825187890575315857483192978575960064721090919020386259819620804570457752889582705610654639297618808739410657616267246433881883297197631197292727437190864954746426290183470555343101386679149575516284297581726911944595396798831958418808183080496768997498687100362268105131926303607352245992783018803948259095316613023357721818686328474623029461728150081870,"H2i":22382474404783131074874895496065243714059095639491950557883879033866681560544003801854356794324952362992847122358406076427416072468068211435879471422468155736802174304216780177064114636545894734742059952082240695954445028746475766985337380610497614496174734864999267616881853946069265809865950174736089814063928182029958954270211910450724831686798178840742368444300288090794680103368405954159965570346571663058625831046209657053599414824624870583662487603183005849933560257730074826245597787251861537865223140826149473303936446206689812635919103767372028258273842200548903184739407401545405191777067514653454086470913,"Alpha":24989214328250976930093177263417665420535146055733865928475975685513180121941645932360252280466455932776423998414720495927442839501026068833857415500424933235630142089470364466727679375825362424051710842655183944061631539321752326549354682438669746529561869624667749673920541190112600049448465969347203456088290555619539821447079255348572738502572531101577945097411707644371988159659808510878375553948507869607526112503982164638054112914023984309314442828479129967948374924216770058343388212981710730788230137757943190085815671936691387399781940433784564585622337233490733196231337041548485866089512924089842993768080,"Beta":182267900385210479877185343324328631268419235676254908430894109489589043598564605095555309608691924037654518807262324791859837258349658820147918258062856907831064850301008618729912196912155300307514950497093956846740858015761466195386525620110013339764827431353777329343290044249600231925933725226373755428290018970456371431953592604621210956282320890060655384292875298348162510673353774297996725769118244622565912870662335671601711194021308094998910810358525879476602841892486729168270473767072581226495186857635208900058065206275039711258938040277198599187899186069917118494477599580606693089780599949553528636698,"P":86280559339831377917178424318877021730887860289888963121228641458530026775393283605277642751254657039259395337151399417425009005343009534206866104306553759457690194734188588374234938765036407229368679556322407025843478848689683035667170835744578315738993657746070371039121762973736867319495817530533562149119,"Q":77259088948534479002431435740006369205036622793381517758721367673199303248160427666471856391963725757606573772925688218695645630106108390223090156949113367994755262444790775897662527907370118248220185291169319394887640058139081063377353703329035898570323621473008097791186093190451693868458245283666843750163}`,
		`{"PaillierSK":{"N":28303161378500688580771071132040469477640323927242518222709841116636070050192717023468842180873067762151142635727713639400846615213093310762810390811028310662618372162397170430793901014599708480766499742583856356853745401015924112125146700526203889332979208013520421072303953731663935591378718199897015882557564355135592305080490533979265212122388531987032326793424506533488716307417573385623357243694747993609963844680362652339348303095422332697996706080906393172783673239703816349792488788857554487609944787806208707227492486555169999743754274521572427180253003091570423590711635158932674920186389072277637746332281,"LambdaN":14151580689250344290385535566020234738820161963621259111354920558318035025096358511734421090436533881075571317863856819700423307606546655381405195405514155331309186081198585215396950507299854240383249871291928178426872700507962056062573350263101944666489604006760210536151976865831967795689359099948507941278613704422562083037625188250873432327791837420761332102273779411422356365678073824467517213619429918473028031059661276684868812042049715586184517288270530030461333808133928593112372130884508276686275562632447879806926470190561577501538360650854898113967208096660272401415484040146906352754315823848232895544786,"PhiN":28303161378500688580771071132040469477640323927242518222709841116636070050192717023468842180873067762151142635727713639400846615213093310762810390811028310662618372162397170430793901014599708480766499742583856356853745401015924112125146700526203889332979208013520421072303953731663935591378718199897015882557227408845124166075250376501746864655583674841522664204547558822844712731356147648935034427238859836946056062119322553369737624084099431172369034576541060060922667616267857186224744261769016553372551125264895759613852940381123155003076721301709796227934416193320544802830968080293812705508631647696465791089572},"NTildei":31094621445721472427589580097089504039117057621785050089123759596359963437197818532549727549393095998699573291040663489552983337297327824017579883152898691268157629478300602057274530610825449877712035680217818531878269992629301160639181347117481167782562745276697595763275542410770075687210355928171727822296747967058866751522321913532366264304297628692865991245057367630131931925920922867066620016172991540595602858386714146566017644368578912438487077031180497689230427800816376014861934576780656283484713081384150090758122117306150508757025818483516903905567573594642571719558808462650883931127070292387503833316033,"H1i":27909996892356044581664191224263145410034026224328721096482472653821933802658277209832882789348860218292258566797760041451082206784355946530828447440307019850858848924402646373125522687130240769832433428918147414416480355722573984197602526460787304067056548493939258609075155295492702349824564703513134020162942789908899536928803760148079329969753005582872092364847858282337443016024350798080403374624275509268218804050472742062267836586175054694177780256792434898226427140961278294844532183384025135082737646957720314924095597029366726958781076968900241068601367810089527451860334276915077909509903764396571758472753,"H2i":21218131472736092859957443292093205095858586022849683940343225148399984429007911303359919903511197092400175547068612036898002435896719378659623332296809176679086159915584243503500220180970298257892979204479318116543118646736819357043538632967180551538548566233595186410453600041113298272051644909221922491268656767818614801954801281876781211623859462860680075568248395592792970419195998570513452706625302444720008209197087651313184585458459960052731797813158213610689824178048777207447927814721054428504046747483945804054221243156440211832986417854025966249228185222218801050168784552220682887660953616691593041348187,"Alpha":4054157869066940029943870427536850888284929382018772920689875716454810905391485641395587294416079007161143989118082018476357158013227496561919716871870934331324171519151722653396530671552017288011197000386154793640233436410435069726379695189356098548744525607764712650045152343076810956943105815849868259068163708100092140331637315232461528330797594340819391724332714446654066986707968593855138609602851290869904171655352003106306655716938263110042709318542467449059119027319174490872505102058552074174870747773289164124993677840250634403949523513269448880081760609675106789947475736401112951332644202421312343945901,"Beta":6932065302848363908548095257402493220675044795281980694729314602632208515588835235417859380531715198290799882273538086231044307904656547320218296665764338234672982262130620177893075258670390034411060972515384498420658834669071363822637504477191399938574730963691678041078535385508507535232308644244983862090746613014164276428726745288786246936509409147055151815844610495936783444470417560111256871728486423292574660920774562430899256222221788306767428958826210871503732479073816678099474026372738810670621785954194339819428556395088738025000351852687649765662013366175074287773755695389117707351873683800698053125281,"P":86649137972855354753649650968004083656252935610058821998584438114087379072412812891363259876466209486488526802001123616312916271538023740355613987096271804611130359055063516620749175175654392728069416742779866896290959369357750454762229052151160425483578581933598874518018175895625677829233614891958847179789,"Q":89714168464845286556075514821511969985733465994931461399772848735311444757321854327042180996126127339980705273486281126531337283453595757260533734882237356913096695451299317514597488131248904085790755946683811742799532434371614965784484182684419565549542666338858117265424406520442398305898989283206523670313}`,
		`{"PaillierSK":{"N":26371052882922431871555724901122237069089182372653952889197603509193310961332998886282836819769779026843087148651765306153335142159769209717983381742243107269768157561534854683357455031800823369776831752104529149081920361725806293157446194309156093634649860570312804884220968263418791084216945853231585632467128386606672741191791564656358134221461239997458114765932155352839104534858257555985373349072904039971748137606895675623109665119476971779699573274697187985528887837762096360111715239715493418568013013157841849210694733343800943399239385371121638324004061651060193425156781791562426371799246719393689758944261,"LambdaN":13185526441461215935777862450561118534544591186326976444598801754596655480666499443141418409884889513421543574325882653076667571079884604858991690871121553634884078780767427341678727515900411684888415876052264574540960180862903146578723097154578046817324930285156402442110484131709395542108472926615792816233401444752882198517493653124781881958305806282441604220707814642841867810076338750975960595783076582494604730858444706305707683403386528100990220706177381000457994862848373104835895284878219819500621996193364813367901418349153165607245018890942562167308705952262418358408377480325836427411581150005209135690486,"PhiN":26371052882922431871555724901122237069089182372653952889197603509193310961332998886282836819769779026843087148651765306153335142159769209717983381742243107269768157561534854683357455031800823369776831752104529149081920361725806293157446194309156093634649860570312804884220968263418791084216945853231585632466802889505764397034987306249563763916611612564883208441415629285683735620152677501951921191566153164989209461716889412611415366806773056201980441412354762000915989725696746209671790569756439639001243992386729626735802836698306331214490037781885124334617411904524836716816754960651672854823162300010418271380972},"NTildei":26456086681264577014174567473479326612118813431297142171335901944384754358520089897751319436700571117018060213750085449016432930864325934397335846804269059129954824157653842978809176731781137433310558493984094046646021833680236630412640117294878076396025749303853071743440436612046000048625591683152542689220659442796789023359782096207843639373796228976646653112700652918722063873644289586964515639608071892775986686674520451380863166590006407555801166515919254070053080348627864507742389014150222825219774335766992698342360632169384884236337399641775170943598415355434184443249465161827329074650685626499014757576721,"H1i":24118267881104861573162005547398744759492124424522066551078577218843455745996429464908441650204823643103623292130976010207699127292170972522196922168908892952444721738965279108044276758693775710787268030117915918352362560135707343789931596273763449365531822146649834753772116978160078139393032646786306990928835579503133668071615978171878471829254052877539814122935599452420139044051058185397916143990275507345539697974368940856502028126403370206205765706588168751016940571271353418044571053723473982163246306121935389732324971175826663616408435083432738074710678357701366999393193833440483257776368317949521143685106,"H2i":7543703636590899434970661082995019960255507504818079302155715187591897270522295371458414764756228735799570063390807694418020867366390494938664041004179030805126253204349218531277701147390738688865025520229413523610450213913924220016976948714185580831609584918850548894290616932186251969313937371697149673741065843376147506494856002876666187839037701633197743387818000798793812969261954164092084896831058751763225627962992977801095351203357429035231256876259320168512885083227465252640777676880796394539413730133545197075692827517411270588670527323706579818236363540093691388931158358254488134094833292506010737674612,"Alpha":13163593692028715282712778189905019349991841415717165444615530721362293231270701613232632161764035301111522133826212513891598620374635333592390820448589400161309732868125200520316198228187866207847406035950504075848455142399886982782074703537322942879990490680112602099022109198590321431602446792573976243651175617436805593812648363188492204223471032180339552000441888206333979703305498747842765439544006591416554876022353739460557700537594582365705010353896713901109754435260138712712946346132728828341297718016857840254375706879916860576021241056233851276182504440945036171111914075436545140649824138497778486166854,"Beta":1579784346283267787195155950387801068495147842260778745818705132626321281241304186707854153807894837089784722365504088517032555619997060427984990528544242930664850917347856134283492132064141233310524531331008952378289532099721263645103678496073724637597434187276515521907376232472687727142379513611958462868502095372203045597170166798729310657031769651331464050732674305817401474682274046345440942252555894694624466578174317072668217366514416685993305991600137867851775428142702773259641680408505453727074809151413607465330566472285014138492627616211873654816796639699627780020825084381567777915621636133117805147348,"P":89764873995987706449888931738863164559050943690564252631590957121090222420352993695304452035003475812481517169987106159234042396503642062885343210364776013609965619099700590564802634125448410354932459549073669725720505693390395011846055893829821430321677450544923916745103433958781680703568780363714822132589,"Q":73681623734154370419033842272561125026623611125542203580146884161357010391674925587272092133798456751402809604461543490557820570133773559437996445631960896034281241728028558886449916742471819349855501863709310470868655799075379996054095994539464069317418229638313303389645792032379355488127886423547250378049}`,
		`{"PaillierSK":{"N":24689075232923178848674115436861949067728502644732226970065501190414946485752255265707166065432617927510890669292241033657013872104573877039011950372968656664225168418286220699853509365177607698403883133370750204802995020848698572430074821361266520833202902950328040279920191981982154671001314074691933117379795643518975557981073078319276152185486930423892987250473602579182855178052057147045983203101194994646355856282993448630218208934029798980011204399974796053930240229231431229629875271148471607060906678610278027311349372421679437192303904377201527319567444250468824754323565288173603219382477901190449952595601,"LambdaN":12344537616461589424337057718430974533864251322366113485032750595207473242876127632853583032716308963755445334646120516828506936052286938519505975186484328332112584209143110349926754682588803849201941566685375102401497510424349286215037410680633260416601451475164020139960095990991077335500657037345966558689740236485170974904032257084233819456948697192373302821503695142550533718352941561832638487163050502984230260416262246083539443829076880317694276809230022477818099088737341899409416274333582576682001608961301101962704890043644133734343115664407750106949691742201089210474989611835029492060596700709552293414802,"PhiN":24689075232923178848674115436861949067728502644732226970065501190414946485752255265707166065432617927510890669292241033657013872104573877039011950372968656664225168418286220699853509365177607698403883133370750204802995020848698572430074821361266520833202902950328040279920191981982154671001314074691933117379480472970341949808064514168467638913897394384746605643007390285101067436705883123665276974326101005968460520832524492167078887658153760635388553618460044955636198177474683798818832548667165153364003217922602203925409780087288267468686231328815500213899383484402178420949979223670058984121193401419104586829604},"NTildei":21365586077195324321628321399278280499412399362347240143734201071570882413100715106499078100006000554533345365376609187114262766602652615859253994999169174293487790981064984128062091984809574003767950708068631758569978721045782691395130198907575968960769461791490364192741801992481361614304537595912650949826683118248633042530295672940351211739659070233417110982930914694699714395655237170118408958650467590748023717439030339604629852841959694254496638114410570231531179260140497619187794354165053832872402340152983228690440500692668608467892052791696761128566451235858981153425538975652343450270409346010102122667721,"H1i":6939999887893385459208347844676144491802219006765107299348902214325847511879172410687071600085559979759993357688043820844305333860016086992950349650212563049182956852800302486408642741674185285152075052142726405085109266560129126152671944459635332808339019590406436015766604175542392155726106336661101073110634743783267044254325856426794611583730923161849143739655060950774210402283880715921228508010047619903946795047883662221997554925404060932008603724396232780022571784301430217261809838938350026453530005186369626730857948645893549249165092635142717983982170434351797324379692984019808638667637041320649753533669,"H2i":10161179370418678758300364362235240699234919394277005346508630209840474590014946736400453763993137239484770725885555211941423810400070892201912139322872138858532388232559173672194934517270117253979086655470353468620275587179231062782889828125614594487964310242892515032704817323933328563683285349561373984702949530334812447660900460921083918005119830834774312164445175625652736246365410134738364295343615584467257946172223429709719121941489058367614816846189245597828852656959440519329359482049818730737987268667605454407732556918411237509546129586034103260317622109181896883757953073144482703204581787288008342370658,"Alpha":1274020666532495479556360683116920609844207030580349007229697464452515066130149897725288739448103402592838215931053970892685891135954242658283314665641809753121524964936169454174849746841915320981857410096951782356374019582754134271621872386397498792584518235591074494216596183348992899825357716649877241500383243471483707695042338568765564790738434927832071992857973778347161167062918152665081054537905674861677323182537707727989477889705197498317258980270477067970511744352065078076061035236710749418849785607108309200256611151126016053412074927188897859987654401139614117143732968947867090362957425398836778028259,"Beta":596815868670330483681990401709463123865039143931938365880723109168059456479948215112358720588475624716023405090305179945093772425499901950562311613418931824635732717547026698386730556164676344161204004609196921644975913169606505150628758463787183724323194999677068409086829666590724747594381477638681691274897719854186393891539445133115741056168999398822760277523708599397524630440711899671698224121821868376336631646337951943364518978219317140312408371619778682567680895124424742667740119182495559890578208430715767116034392650015534399811849541699738013770135547928172681299414436651367389732716307969518502076340,"P":72070350431612185707556746733025842386475670211942225226407368651976343119768863947796605249038316073511065439530458999841231622806261837427750748815605543047716250672370238990488332072212631677208067744955638592421070571807280623960025961234823182547592113125658807487686319884295582466022246269821910894873,"Q":74113647114388619711257850368885125131871304565759177932148671841861187011607567455187622351501388614480043187252542107982833341302183899798159056136355461448877735402281542389600921324864657768560266565914350965356428666496137067692846186729145189959478597990650987244584982568703544045290113120277918806921}`,
		`{"PaillierSK":{"N":21421943701122964494464447994440040972055687606080691332360204859109010511571275190575572278826554595456808975674875674400354274646339603309176139631812390984409577238920386315584037329762198298324825822192804600804027071889607499101233679309150283782956499408320334152953184567396495304599012426140692070184861316409283909843481919557572957271145533330243890490985243913457347706632799456800303284408612880121674339344215558223435722804912115542742642444314342665418630087267980295574092497588856374194614181980701693013760402350029271742513220248559595348398488706295991881789133139334726817059405429673091525828041,"LambdaN":10710971850561482247232223997220020486027843803040345666180102429554505255785637595287786139413277297728404487837437837200177137323169801654588069815906195492204788619460193157792018664881099149162412911096402300402013535944803749550616839654575141891478249704160167076476592283698247652299506213070346035092284147768208998938401608371396067907626633104422007219640070847257821362383470543007981112414021014171329047128848392231307123579956502888542188690168091834261529612788115468370645912567001416506798051295558676469282708077206608758211884266812617014571753483455095689737677520831757711810609436387617344426946,"PhiN":21421943701122964494464447994440040972055687606080691332360204859109010511571275190575572278826554595456808975674875674400354274646339603309176139631812390984409577238920386315584037329762198298324825822192804600804027071889607499101233679309150283782956499408320334152953184567396495304599012426140692070184568295536417997876803216742792135815253266208844014439280141694515642724766941086015962224828042028342658094257696784462614247159913005777084377380336183668523059225576230936741291825134002833013596102591117352938565416154413217516423768533625234029143506966910191379475355041663515423621218872775234688853892},"NTildei":25019031766441960446335915379730515533888092429560058820391320368447117968064437769148393041612760558631669966546483950838833715847413336606149523420640146959992733168205725610227987528626697601024165996958487334723188000764574692534497653836356562735538341564896563732834737474010427851799724441620843526019035921433817483192055367334776182051911042992341846683981603040262114494978103794251264446826147335334617080288032378953362515525959737691159148014336616809047329845161728974385113225292007719661544633935803116677839233178103055117404141268118239332930743425717032022817831767351644679799035610216548735502937,"H1i":21322169583153838950472203426900356842782306037056526125931464750562499591870550451930697846028527615061662715258761985327334276329088323088420712905874612951662181673229952322775836452205034933502533673319334626073199952733750171152431216213995174159550874231781495488211057579105517048537288174430306419126566457206967931787105107324493157361572019236650313314977302995976159839462313827493370137936757092345853951451186877490211807616359611032429644627560417098390933870560569117138726412847983819674548014767706351568121709304394404765058341059759808675736180906412358125587556593548083822017523773460106687854679,"H2i":13547980284423542756557631116651131193748023062517734277160659752242570629427430714945389917459199479174244108196929025139580995359755038999793520423710681953622445800888345618602279890299240997574257492516346468558324483918393478860977433437728630998780506921520663804751127384180315039665148138836514487198161319145713368179338943300243590294177402502093224465932874759357942679270430569367642648919935856850776354813505674315850335905547647198182329641684305110952864349867233443544729600041033123217175412611995451878518096634830719758826873700111038457903463962816016286564656641301579965035671325158981944086015,"Alpha":6796601969508671188728603577537763719546075344607309318356277562639134674747173543994838990847920548055600030957487325073032279036562469103650908426110743479343404997948437271546759693009877711318371214690711397032429632337835295855938039579610621516031262858120213741198423767572901631853937605450402414276096954368242087048645739359633321216202642994001493012040947313210154576021527037841984200939336215197954843240946323397630301633902086126282560481525937635939990688235526192029890018248458055607465744872186948826645152078921370486807622369044888454309904905972399579073505216212906458268599213242117460139158,"Beta":4129379259681932530535982950439963837407665550303567973393335541599079908871161855687101962268579582153905249198848064987163210237937492984979157506190709594044111996045578113683662056239052896617418250674479369157365576155695418442950322589144589998924828251268139923273798023205594964218350723963789291852860616767185565649287472649031381417887512549626454831320961241802612386935009479565860127767105392897059037791512084529381549151525965700291426221885649917285155165620554695457564352942987927086893158516118709899715275147468091575978665714120262004979138794318409023825032813910960608513734867387862125771644,"P":83515905174030171122333595475227543934464410429198323068178707486809412566094473226383149677710638643961143872091749081356377964955189919870726346632711646686722333451114446335298521919292217006175947609645170697065317825374136704967736262397245368685040919240557705858928722539189905093230550127450401421761,"Q":74893015032009123168765624481544511724868882619710244598160124454863696383123409430332228148198913436477536769465207023127481591636535123993583959827566035178141610778340311529255578159129350671236563400378394620935245740570940722834274763558087497656479928906689041626531469938181434962959088812182325206009}`,
		`{"PaillierSK":{"N":20750184317387855689857536578769800568398775995458153431066943803954739711956747528996498408123500439326850270714069736263997979705884716457710325060011378377327636634559919416693197807095598160651204219250720561812973163169905904700759772950404727872393920431565337803347577678831262835938391164494816380119179864565783039830081533076735872037620434383605571270244466568730120595085657209125555269232666389002416757228201853474206781933188254461331135357238662819245356142943105975860050065768144639961833637793647141700602658282569947427732312252750455319679456438475602715197066314206988735373926133536348451836909,"LambdaN":10375092158693927844928768289384900284199387997729076715533471901977369855978373764498249204061750219663425135357034868131998989852942358228855162530005689188663818317279959708346598903547799080325602109625360280906486581584952952350379886475202363936196960215782668901673788839415631417969195582247408190059445617940569429827721677239060977748737258689268382769787717802304191090078895593768172231652382575174839914139360296881884531224090531457481792556394978555199423779522930598231849902995868911477491974892736278499388920995571256687104686869162127938226499725867108605104088442044913830873020236076474688822302,"PhiN":20750184317387855689857536578769800568398775995458153431066943803954739711956747528996498408123500439326850270714069736263997979705884716457710325060011378377327636634559919416693197807095598160651204219250720561812973163169905904700759772950404727872393920431565337803347577678831262835938391164494816380118891235881138859655443354478121955497474517378536765539575435604608382180157791187536344463304765150349679828278720593763769062448181062914963585112789957110398847559045861196463699805991737822954983949785472556998777841991142513374209373738324255876452999451734217210208176884089827661746040472152949377644604},"NTildei":23021985643048870665624184298459633255426179552672906621159970232449061573391632353524905870563018973874649164322170608672562834560729114146978379864763348434901335245114896978046549683408898319488717091904285721451152067157248442175635070241981396064213341151790920551035155754017333406310326849595743377193068327186174291694069938135401470322459186121306406757953350763243171710413025765486601343100805075262948167916221327866178597935285031238932862360396737659838240982711677474504204876168986726148443550143473005545183815848172693760548552822221911863453783686743698111355362344150302615078620873335220011900869,"H1i":711766492723711915627027797083212733388727097333546719060402431458079056426842542343548851786538701958080232865043404725050127241608925286556986526014509395004495798706765976633470899685152794091394945988683854813140237233905706367120044657468055700569020207997666301032768430717734445472005149715144401410085686195483084956542298921846860735912917073936626072859966608183710990103212084585794054803057276690407984874503386040800444684857872180048550870114247120238401483033502587788691299928062920362891753690963105414916782963726484461129647852018389854929659313371926823845024611693111574084225889083616030690702,"H2i":16447276962314219030983590245133197387153751854128176018211361966314111562304257940466625442307353657649334700336625167534248627518197331833886941379161123626236777116213165732019436111989246904027022634556097060646312838051534714440398957768560826926980058208409589635598115147977280536452981586140701985534857924972331215327679637364547027946996265505999917834536548599813574270662807018172116195978424956994487716237865115367776748077718944479201479156827364499149889157499812266512341339940178889924401811057350101277132084473890627167450730165580800830212494951106395246072773816324041903980040263685836804672625,"Alpha":20746740327616350770184323910348297327635826095806083416155849009953371932725794655258524474438833534316585060722902884778281467948568768123867679332194863105313766301914433753762136980260541533054858253224946866756916877468794280246126341756671885122851946063733071327406867058839961232967950299260083065910683815830579569903457431646804111923722258819586015828642651929325690725631268136864558204931079454145756806364308567205799228036068805917791208805487341768884329000908701493988213060112898118050972108303115750716244488660742433115753021762564304755104034617010435675209206376837838846252767116399612511528804,"Beta":3016434987181695366922481072413541553959632355590186577737240408026515112434300341808979375628825496757130028964338701179586241316590644331333425119148813783185245113698157387122184124117708092925655564780531390401984167067830699124656353326104989178315310174009745684535070269980644256576167605218843144632187400416989196020867210156411914147575243079246793705230814125024421956366262526837054810009911880488042535016449852820700306383405505968557357273033789100850867649426620023771501499119505701797444639794417149679513185893111017868425683327158988243197955713823521568591321063400942852144452535349019939667183,"P":83970548557097309572323736806556362928133100936580356255295351734114488244041560216146565592361776126947019805729352258275713708429839554116476189877587218642449471226174402770024751397589420602822202029394007107581170274088132006933083271176275446857318634186156128413739098395255319539904013334259597577361,"Q":68541846036038012358914543665833239032604758010186696361050952705644145119203023605446093108855161666890982715535460364641756516353670456627226360163335582236515114181808475423621615310478566092907716170853340221481518716759106784772027288915071832632805708365034850753682041903952234437235632046824760691451}`,
		`{"PaillierSK":{"N":28147568038893597883543825300541270680259935177054062172934317553092312039099129337493507752112927746841620959695847505118817413870981925378553085997823130734558838234816713046792732423066544701539975753488377295514481269520743097188397367878366085736885817319062566842344439272724146179587317741045589633284916626889932169187972412772645750389391815976193387451110572191287686042342807374172478691672051494752482599388095009950195899497870271904938138133961709128760076876797101155921293250912212063197976985760118034928493382357411557607982291044790393251982358781850187860348481912400856249446324624211503604383861,"LambdaN":14073784019446798941771912650270635340129967588527031086467158776546156019549564668746753876056463873420810479847923752559408706935490962689276542998911565367279419117408356523396366211533272350769987876744188647757240634760371548594198683939183042868442908659531283421172219636362073089793658870522794816642290275738207355151317380861845675953612433185925240989232234618348383464491950037245475665386491854272198960730633367403783306483324013827525084034948395883473788867731980225608132073393422073304443460179785555176093893908438712554741811182839472680154233899158766991544797202968702232811607354450087711739686,"PhiN":28147568038893597883543825300541270680259935177054062172934317553092312039099129337493507752112927746841620959695847505118817413870981925378553085997823130734558838234816713046792732423066544701539975753488377295514481269520743097188397367878366085736885817319062566842344439272724146179587317741045589633284580551476414710302634761723691351907224866371850481978464469236696766928983900074490951330772983708544397921461266734807566612966648027655050168069896791766947577735463960451216264146786844146608886920359571110352187787816877425109483622365678945360308467798317533983089594405937404465623214708900175423479372},"NTildei":24970191804616513696862954588504783614917770297632448244085379664094791056592856317988144284642920829836139705704549900314908711071305955165044889263970199248303988144291857475416052408253660361676748711614073086077047574393578238975443737792180014681834512750254009781216499491850142565308428755960010060119950393387069767448649066122826818811850052833247348197450854595271159832093879074614819647764832342915950499236620157033117054252575075516918739797805670511768162661886877608815415844202864505976649581473656506266917094622856119973058964605055986777699127974035405528443393342650004063060881379659910777291761,"H1i":16871322740956569482033985971813357189208018291186306256843038937118314346888263067262664225036237306740031319942446099212674271100676697407403687909433884955109231787320153191628966192152647175360924625976965239845684528616147588620166608463741000080441164005845759638185774885215363504389693578764533331515549307911791548843618191040238915718449518389206922940622693442085175545243051253060520551666952158007034016618857261460487004814673564500210403512319245630576038050593135522971706970465827952235797882501371259108342881990139564151814635343420273645386368630928998299247481568391910437840017072352180113462316,"H2i":2820925303849682010880519631659786329629938385413578141430811336757492363071763688261209424542958908524398897038736902443545508440165017591119981170416413074133274770701635327088490683496572578983683005217362568149151947167966287759923996396147737850698245678421065109734801601283564754859874180759725084984006708524495695926569340605966035336324136352399049770443205375122919243845553374431174707715813007793780244759880273045861116798728765724625508771775064217505782661913294518577876671375103189834792049977848575529231597478329928217473842842766064819817828118587208806842291368092515307060518820877191420066207,"Alpha":6686485882260689890710991274663073775713826231634547377303163696510986595624364615694647844313571347797603771736713809925979076051214618116403912500958078477879785571836912494762003298924934592864698153406224304054649674232162691520958129907084553125537888221990316412440602475862619517508788815419272675309271040129724586626459049084165668461108442659869115178672279448631504060913647201733210486045787462629015974611152300960176270962592868342563431753526401170988908761637105858974118102238359116523565714684216666093785266679356068478489376419382162783127446728571996985437580160299863407729534244499170480389707,"Beta":2669311941019259834595626705127608868935925224978492227313105278256429539637751061986254746348905434166900943696272328388534674564326074002837553821868143267609171868339486895152470084297256946773264769347540981333187395826273846611594339691797059598326605290773559501799074074748329143177713967118872702863256410244261909334529330708993112378276258363485664477938585523046927302103909035333722399255156719095398102667957676723808024917763887019325624151697862708838408080636495031102704606045113283197980656533156532810334503936181032678566735675570121538891524617103997085711791444121005395954551747667792843508377,"P":86887313209139231574803217448710261573054690671219334349527366723679771658681707075269559912995408576569136857576360580596010603453015810956166281095102151329295366529266172849120699709703787531026821299415972308944165081033977687990565946834281849467128857947212695379731535803481382355287181424231869427743,"Q":71846483917947951575676495349217142500808281508308811783881863425469939913060288966390682401569630712198359909534788825404907642928088163050635257817428997428671071822330297982006472545050176259952852200587117541879287385338964919099221797501446874110756654603014438104742864225841427029781188656235565950951}`,
	}
)

func preloadPreparams(db db.Database, cfg config.HeartConfig) {
	var index int

	switch cfg.Db.Schema {
	case "dheart0":
		index = 0
	case "dheart1":
		index = 1
	case "dheart2":
		index = 2
	case "dheart3":
		index = 3
	case "dheart4":
		index = 4
	case "dheart5":
		index = 5
	case "dheart6":
		index = 6
	case "dheart7":
		index = 7
	case "dheart8":
		index = 8
	case "dheart9":
		index = 9
	}

	preparams := &keygen.LocalPreParams{}
	err := json.Unmarshal([]byte(Preparams[index]), preparams)
	if err != nil {
		panic(err)
	}
	db.SavePreparams(preparams)
}
